tests
testHS256SignatureValidation

	| jwtCompactSerialized jws sharedSecret |

	jwtCompactSerialized := 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiZi5vcnRpekBtZXJjYXBzb2Z0d2FyZS5jb20iLCJuaWNrbmFtZSI6ImYub3J0aXoiLCJwaWN0dXJlIjoiaHR0cHM6Ly9zLmdyYXZhdGFyLmNvbS9hdmF0YXIvZjI5YzZjNDk0OTY4NTM3OTg0ZDhhNjgzZDZhMDMyNjU_cz00ODAmcj1wZyZkPWh0dHBzJTNBJTJGJTJGY2RuLmF1dGgwLmNvbSUyRmF2YXRhcnMlMkZmLnBuZyIsInVwZGF0ZWRfYXQiOiIyMDE3LTA5LTI3VDE0OjU2OjMzLjY1MVoiLCJlbWFpbCI6ImYub3J0aXpAbWVyY2Fwc29mdHdhcmUuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImlzcyI6Imh0dHBzOi8vbWVyY2FwLmF1dGgwLmNvbS8iLCJzdWIiOiJhdXRoMHw1OThiNTEwNGM1MDBlYjU5YTViNzlhYzAiLCJhdWQiOiJKUlJRNW9ZZVdxZ3ZoOXdOUm1KTWFob0s5NW5XSU8yaSIsImlhdCI6MTUwNjUyNDE5MywiZXhwIjoxNTA2NTI3NzkzfQ.JaXc-5gnGwM6oR4G7bXES1iYQcNl6C2D2zW0ywzchLU'.

	jws := JSONWebTokenParser new parse: jwtCompactSerialized.

	sharedSecret := 'O2JAODcPv_1h0BUavNKHkvMyVKeMVF5mdDIPBIIpZVJjBqyW0ggA7J3GKxJbmTHD'.

	self assert: ((JWSValidator new validate: jws wasSignedWith: sharedSecret))