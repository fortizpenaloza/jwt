tests
testRS256SignatureValidation

	| jwtCompactSerialized jws sharedSecret |

	jwtCompactSerialized := 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Ik1EWXdOVUUwUWpjM1FrUkJRVGt4TUVZeE5FWXpNRGRHTlVZMk1FVTVNRGhETXpVek1UTkJNUSJ9.eyJpc3MiOiJodHRwczovL21lcmNhcC5hdXRoMC5jb20vIiwic3ViIjoiYXV0aDB8NTk4YjUxMDRjNTAwZWI1OWE1Yjc5YWMwIiwiYXVkIjoiaHR0cHM6Ly9tZXJjYXAuYXV0aDAuY29tL2FwaS92Mi8iLCJpYXQiOjE1MDY2MzM5NTIsImV4cCI6MTUwNjY0MTE1MiwiYXpwIjoiSlJSUTVvWWVXcWd2aDl3TlJtSk1haG9LOTVuV0lPMmkiLCJzY29wZSI6InJlYWQ6Y3VycmVudF91c2VyIHVwZGF0ZTpjdXJyZW50X3VzZXJfbWV0YWRhdGEgZGVsZXRlOmN1cnJlbnRfdXNlcl9tZXRhZGF0YSBjcmVhdGU6Y3VycmVudF91c2VyX21ldGFkYXRhIGNyZWF0ZTpjdXJyZW50X3VzZXJfZGV2aWNlX2NyZWRlbnRpYWxzIGRlbGV0ZTpjdXJyZW50X3VzZXJfZGV2aWNlX2NyZWRlbnRpYWxzIHVwZGF0ZTpjdXJyZW50X3VzZXJfaWRlbnRpdGllcyIsImd0eSI6InBhc3N3b3JkIn0.Al6VXN_QdxP-OnVCfeKWKpST-x2ZW5Q_KFhk9x_rKC1hJoNOODkzTC9oR25jCp4jn7ynsL5Z9T2peQt3f6eINxOARakjwBRmJ8yCqqWWeFwphf0YRfSzW_gGsHgXTZTbs2eNpGXfABP-eMhRSKLdgFbH15caTZZBWWxqQEhWtLDWJtTRNzbtncYTfojyrFxME1FWKJw3jdCwx9relRCVb6m1yII4c-GEBruYFonqLO5Mav2FwJYLkJMTXNxG9KBEQXDmRdtZhc7efLKwrfzXTDAGvn4ORjlrNNR9Qntdg3yAqBbVoOv5lj9WsUcB355QBVJ_gD3e0q-j73s-VfhFrg'.

	jws := JSONWebTokenParser new parse: jwtCompactSerialized.
	
	sharedSecret := 'O2JAODcPv_1h0BUavNKHkvMyVKeMVF5mdDIPBIIpZVJjBqyW0ggA7J3GKxJbmTHD'.

	self assert: ((JWSValidator new validate: jws wasSignedWith: sharedSecret))